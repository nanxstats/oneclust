<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="oneclust">
<title>Maximum Homogeneity Clustering for One-Dimensional Data • oneclust</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum Homogeneity Clustering for One-Dimensional Data">
<meta property="og:description" content="oneclust">
<meta property="og:image" content="https://nanx.me/oneclust/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">oneclust</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/oneclust.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nanxstats/oneclust/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Maximum Homogeneity Clustering for One-Dimensional Data</h1>
                        <h4 data-toc-skip class="author">Nan Xiao &lt;<a href="https://nanx.me" class="external-link uri">https://nanx.me</a>&gt;</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nanxstats/oneclust/blob/HEAD/vignettes/oneclust.Rmd" class="external-link"><code>vignettes/oneclust.Rmd</code></a></small>
      <div class="d-none name"><code>oneclust.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>oneclust implements the maximum homogeneity clustering (partitioning)
method for univariate data described in <span class="citation">Fisher
(1958)</span> via dynamic programming. Given a one-dimensional numerical
vector <span class="math inline">\((a_1, a_2, \ldots, a_n)\)</span>, a
weight vector <span class="math inline">\((w_1, w_2, \ldots,
w_n)\)</span>, and a positive integer <span class="math inline">\(k &lt;
n\)</span>, the algorithm seeks to minimize</p>
<p><span class="math display">\[
D = \sum_{i = 1}^{n} w_i (a_i - \bar{a_i})^2
\]</span></p>
<p>when each <span class="math inline">\(a_i\)</span> is assigned into
<span class="math inline">\(k\)</span> clusters. <span class="math inline">\(\bar{a_i}\)</span> is the weighted mean of the
cluster that <span class="math inline">\(a_i\)</span> belongs to. Fisher
proved that the optimal partitions have to be <em>contiguous</em>.
Contiguous means for <span class="math inline">\(i &lt; j &lt;
k\)</span>, if <span class="math inline">\(a_i\)</span> and <span class="math inline">\(a_k\)</span> are assigned to the same cluster,
then <span class="math inline">\(a_j\)</span> must also be assigned to
the same cluster — otherwise the partition would be suboptimal. This
fact leads to a substantially reduced number of possible partitions and
dynamic programming solutions.</p>
<p>Intuitively, maximum homogeneity clustering can be used to smooth the
data and reveal its structures. It has some potential applications in
data pre-processing and post-processing in statistical machine
learning.</p>
</div>
<div class="section level2">
<h2 id="feature-engineering-for-high-cardinality-categorical-features">Feature engineering for high-cardinality categorical features<a class="anchor" aria-label="anchor" href="#feature-engineering-for-high-cardinality-categorical-features"></a>
</h2>
<p>Categorical features with high cardinality or rare levels pose a
common challenge when building certain types of supervised learning
models. For example, classification trees might only be able to handle a
limited number of levels in categorical predictors, because a binary
node split on a categorical feature with <span class="math inline">\(l\)</span> levels means finding one from <span class="math inline">\(2^{l-1}\)</span> possible combinations thus
computationally intractable.</p>
<p>To tackle this problem, <span class="citation">Breiman et al.
(1984)</span> discussed splitting a categorical feature into two subsets
when the response is binary, and generalized Fisher’s result to
arbitrary convex node impurity functions. Lightgbm <span class="citation">(G. Ke et al. 2017)</span> <a href="https://lightgbm.readthedocs.io/en/latest/Features.html#optimal-split-for-categorical-features" class="external-link">employs
this method</a> to find the optimal split by sorting the histogram based
on the training objective. As such, besides one-hot encoding and
hashing, recoding high-cardinality categorical features with histogram
sorting and maximum homogeneity partitioning could be a viable feature
engineering strategy in practice. The application is also not limited to
tree models.</p>
<div class="section level3">
<h3 id="simulated-postal-code-data">Simulated postal code data<a class="anchor" aria-label="anchor" href="#simulated-postal-code-data"></a>
</h3>
<p>In this section, we simulate a high-cardinality variable with a
binary response. The key assumption here is: the probabilities of having
which response correlate to the size of the level. After the data is
generated, we use maximum homogeneity clustering on the (sorted)
histogram of the categorical variable. Our goal is to verify if the
clustering results can uncover this level size structure and potentially
help the classification modeling later. This example is derived from the
“rare levels” vignette in the vtreat package <span class="citation">(Zumel and Mount 2016)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://nanx.me/oneclust/">"oneclust"</a></span><span class="op">)</span></span></code></pre></div>
<p>Generate a training set and an independent test set:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_postcode_levels.html">sim_postcode_levels</a></span><span class="op">(</span>nlevels <span class="op">=</span> <span class="fl">500</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_postcode_samples.html">sim_postcode_samples</a></span><span class="op">(</span><span class="va">df_levels</span>, n <span class="op">=</span> <span class="fl">100000</span>, threshold <span class="op">=</span> <span class="fl">3000</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">43</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_postcode_samples.html">sim_postcode_samples</a></span><span class="op">(</span><span class="va">df_levels</span>, n <span class="op">=</span> <span class="fl">100000</span>, threshold <span class="op">=</span> <span class="fl">3000</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">44</span><span class="op">)</span></span></code></pre></div>
<p>The categorical variable has 500 (unique) levels of postal codes. The
training and test set each has 100,000 samples. The level size follows a
log normal distribution <span class="math inline">\(LN(\log(4000),
1)\)</span>. For postal code levels with fewer than 3,000 samples, they
are defined as “rare levels” and has a probability of 0.2 to get
response label 1. Otherwise, the level has a probability of 0.1 of
getting response label 1. The rest of the samples will get a response
label 0.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_levels</span><span class="op">)</span></span>
<span><span class="co">#&gt;    size postcode</span></span>
<span><span class="co">#&gt; 1 15756   z04113</span></span>
<span><span class="co">#&gt; 2  2274   z04578</span></span>
<span><span class="co">#&gt; 3  5751   z02580</span></span>
<span><span class="co">#&gt; 4  7532   z01457</span></span>
<span><span class="co">#&gt; 5  5993   z03546</span></span>
<span><span class="co">#&gt; 6  3597   z04056</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span></span>
<span><span class="co">#&gt;   postcode label is_rare</span></span>
<span><span class="co">#&gt; 1   z04546     0   FALSE</span></span>
<span><span class="co">#&gt; 2   z03223     0   FALSE</span></span>
<span><span class="co">#&gt; 3   z01687     0   FALSE</span></span>
<span><span class="co">#&gt; 4   z01301     0    TRUE</span></span>
<span><span class="co">#&gt; 5   z00848     0   FALSE</span></span>
<span><span class="co">#&gt; 6   z03046     0   FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="co">#&gt;   postcode label is_rare</span></span>
<span><span class="co">#&gt; 1   z01482     1   FALSE</span></span>
<span><span class="co">#&gt; 2   z03825     1   FALSE</span></span>
<span><span class="co">#&gt; 3   z02533     0   FALSE</span></span>
<span><span class="co">#&gt; 4   z03640     1   FALSE</span></span>
<span><span class="co">#&gt; 5   z01608     1   FALSE</span></span>
<span><span class="co">#&gt; 6   z02130     0   FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recode-the-training-set">Recode the training set<a class="anchor" aria-label="anchor" href="#recode-the-training-set"></a>
</h3>
<p>For the training set, we cluster the postal codes into 32 clusters by
the size of each level (histogram):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">32</span></span>
<span><span class="va">level_hist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">postcode</span><span class="op">)</span></span>
<span><span class="va">level_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oneclust.html">oneclust</a></span><span class="op">(</span><span class="va">level_hist</span>, <span class="va">k</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="va">feature_tr_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span></span>
<span><span class="va">feature_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">level_new</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">postcode</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">level_hist</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">feature_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">feature_tr</span>, levels <span class="op">=</span> <span class="va">feature_tr_levels</span><span class="op">)</span></span></code></pre></div>
<p>The postal codes belong to the first five clusters have a higher
probability (approximately 0.2) of getting label 1. The other clusters
have a lower probability (around 0.1) of getting label 1:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_tr</span>, <span class="va">train</span><span class="op">$</span><span class="va">label</span>, lty <span class="op">=</span> <span class="fl">0</span>, xlab <span class="op">=</span> <span class="st">"Cluster"</span>, ylab <span class="op">=</span> <span class="st">"Label"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.2</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.1</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
<p>We can also verify that the number of the samples in the first five
clusters is close to the actual number of samples in the “rare
levels”:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">is_rare</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10496</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">feature_tr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9693</span></span></code></pre></div>
<p>When the specified number of clusters <span class="math inline">\(k\)</span> is smaller, the results might not be as
good though.</p>
</div>
<div class="section level3">
<h3 id="recode-the-test-set">Recode the test set<a class="anchor" aria-label="anchor" href="#recode-the-test-set"></a>
</h3>
<p>In practice, we should encode the postal codes in the test set with
the same cluster labels as we used in the training set, so that the
classification models can be correctly applied to the test set.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_te</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">level_new</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">postcode</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">level_hist</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">feature_te</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">feature_te</span>, levels <span class="op">=</span> <span class="va">feature_tr_levels</span><span class="op">)</span></span></code></pre></div>
<p>Check if the recoded variable has the similar label pattern:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_te</span>, <span class="va">test</span><span class="op">$</span><span class="va">label</span>, lty <span class="op">=</span> <span class="fl">0</span>, xlab <span class="op">=</span> <span class="st">"Cluster"</span>, ylab <span class="op">=</span> <span class="st">"Label"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.2</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.1</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">is_rare</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10610</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">feature_te</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9883</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="grouping-coefficients-in-regression-models">Grouping coefficients in regression models<a class="anchor" aria-label="anchor" href="#grouping-coefficients-in-regression-models"></a>
</h2>
<p>Besides sparsity and other properties, the <em>homogeneity</em> of
the estimated coefficients in linear regressions is an important
property — meaning certain groups of variables should be encouraged to
share the same coefficients <span class="citation">(Z. T. Ke, Fan, and
Wu 2015)</span>. The source of homogeneity could be attributed to the
systematic similarities between variables, for example, financial assets
that belong to the same sector, or sets of adjacent variables with
strong spatial correlation <span class="citation">(Lin et al.
2017)</span>.</p>
<div class="section level3">
<h3 id="simulated-regression-data">Simulated regression data<a class="anchor" aria-label="anchor" href="#simulated-regression-data"></a>
</h3>
<p>We use an fused lasso regression model on simulated data to
illustrate the potential application in post-processing the
coefficients. The example is derived from the vignette in the genlasso
package <span class="citation">(Tibshirani, Taylor, et al.
2011)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">i</span> <span class="op">&gt;</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">i</span> <span class="op">&lt;</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="va">i</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">i</span> <span class="op">&lt;</span> <span class="fl">70</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="raw-estimates">Raw estimates<a class="anchor" aria-label="anchor" href="#raw-estimates"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># # If genlasso is available:</span></span>
<span><span class="co"># out &lt;- genlasso::fusedlasso1d(y)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"out.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># beta1 &lt;- coef(out, lambda = 1.5)$beta</span></span>
<span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"beta1.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="soft-thresholding">Soft-thresholding<a class="anchor" aria-label="anchor" href="#soft-thresholding"></a>
</h3>
<p>We can use soft-thresholding to transform the raw coefficient
estimates into zero and non-zero values:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># beta2 &lt;- genlasso::softthresh(out, lambda = 1.5, gamma = 1)</span></span>
<span><span class="va">beta2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"beta2.rds"</span><span class="op">)</span></span>
<span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">beta2</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1L</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta2</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="va">grp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zero"</span>, <span class="st">"Non-zero"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">grp</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="clustering-k-2">Clustering (k = 2)<a class="anchor" aria-label="anchor" href="#clustering-k-2"></a>
</h3>
<p>We can also use the maximum homogeneity clustering method to group
the coefficients into two clusters:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oneclust.html">oneclust</a></span><span class="op">(</span><span class="va">beta1</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta1</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="va">cl1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl1</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl1</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="clustering-k-3">Clustering (k = 3)<a class="anchor" aria-label="anchor" href="#clustering-k-3"></a>
</h3>
<p>If needed, we can increase <span class="math inline">\(k\)</span> to
get more groups of coefficients:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oneclust.html">oneclust</a></span><span class="op">(</span><span class="va">beta1</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta1</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="va">cl2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl2</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl2</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="clustering-while-preserving-data-order-k-5">Clustering while preserving data order (k = 5)<a class="anchor" aria-label="anchor" href="#clustering-while-preserving-data-order-k-5"></a>
</h3>
<p>We sorted the data before clustering in all previous examples. Since
the data has a strong spatial correlation, we may need to preserve the
order of the data points when clustering them. This was called the
“restricted problem” in <span class="citation">Fisher (1958)</span>. To
solve such problems, use <code>sort = FALSE</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oneclust.html">oneclust</a></span><span class="op">(</span><span class="va">beta1</span>, k <span class="op">=</span> <span class="fl">5</span>, sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta1</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="va">cl3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl3</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl3</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="sequential-data-peak-calling-and-segmentation">Sequential data peak calling and segmentation<a class="anchor" aria-label="anchor" href="#sequential-data-peak-calling-and-segmentation"></a>
</h2>
<p>For sequential data such as time series data, the algorithm might be
useful for peak calling and segmentation.</p>
<div class="section level3">
<h3 id="simulated-time-series-data">Simulated time series data<a class="anchor" aria-label="anchor" href="#simulated-time-series-data"></a>
</h3>
<p>We use an example from <code>pracma::findpeaks()</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, len <span class="op">=</span> <span class="fl">1024</span><span class="op">)</span></span>
<span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.13</span>, <span class="fl">0.15</span>, <span class="fl">0.23</span>, <span class="fl">0.25</span>, <span class="fl">0.40</span>, <span class="fl">0.44</span>, <span class="fl">0.65</span>, <span class="fl">0.76</span>, <span class="fl">0.78</span>, <span class="fl">0.81</span><span class="op">)</span></span>
<span><span class="va">hgt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">4.2</span>, <span class="fl">2.1</span>, <span class="fl">4.3</span>, <span class="fl">3.1</span>, <span class="fl">5.1</span>, <span class="fl">4.2</span><span class="op">)</span></span>
<span><span class="va">wdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.005</span>, <span class="fl">0.006</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.005</span>, <span class="fl">0.008</span>, <span class="fl">0.005</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psignal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">pos</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">psignal</span> <span class="op">&lt;-</span> <span class="va">psignal</span> <span class="op">+</span> <span class="va">hgt</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">pos</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">wdt</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">psignal</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="peak-calling-k-2">Peak calling (k = 2)<a class="anchor" aria-label="anchor" href="#peak-calling-k-2"></a>
</h3>
<p>Group the signal into two clusters:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oneclust.html">oneclust</a></span><span class="op">(</span><span class="va">psignal</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">psignal</span>, type <span class="op">=</span> <span class="st">"h"</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>Cluster 2 covers the peak locations — the method did not specify a
single data point as the peak, instead, it finds intervals.</p>
</div>
<div class="section level3">
<h3 id="peak-calling-k-4">Peak calling (k = 4)<a class="anchor" aria-label="anchor" href="#peak-calling-k-4"></a>
</h3>
<p>If we increase <span class="math inline">\(k\)</span>, there will be
fewer intervals included in the peak cluster (Cluster 4), with narrower
peak intervals:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oneclust.html">oneclust</a></span><span class="op">(</span><span class="va">psignal</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">psignal</span>, type <span class="op">=</span> <span class="st">"h"</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>One may also use the parameter <code>w</code> in
<code><a href="../reference/oneclust.html">oneclust()</a></code> to use the weighted version of the algorithm and
amplify the signal.</p>
</div>
<div class="section level3">
<h3 id="segmentation-k-6">Segmentation (k = 6)<a class="anchor" aria-label="anchor" href="#segmentation-k-6"></a>
</h3>
<p>For segmentation, we should respect the order of the data:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oneclust.html">oneclust</a></span><span class="op">(</span><span class="va">psignal</span>, k <span class="op">=</span> <span class="fl">6</span>, sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">psignal</span>, type <span class="op">=</span> <span class="st">"h"</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="../reference/cud.html">cud</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="oneclust_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-breiman1984classification" class="csl-entry">
Breiman, Leo, Jerome Friedman, Charles J Stone, and Richard A Olshen.
1984. <em>Classification and Regression Trees</em>. CRC Press.
</div>
<div id="ref-fisher1958grouping" class="csl-entry">
Fisher, Walter D. 1958. <span>“On Grouping for Maximum
Homogeneity.”</span> <em>Journal of the American Statistical
Association</em> 53 (284): 789–98.
</div>
<div id="ref-ke2017lightgbm" class="csl-entry">
Ke, Guolin, Qi Meng, Thomas Finley, Taifeng Wang, Wei Chen, Weidong Ma,
Qiwei Ye, and Tie-Yan Liu. 2017. <span>“Lightgbm: A Highly Efficient
Gradient Boosting Decision Tree.”</span> In <em>Advances in Neural
Information Processing Systems</em>, 3146–54.
</div>
<div id="ref-ke2015homogeneity" class="csl-entry">
Ke, Zheng Tracy, Jianqing Fan, and Yichao Wu. 2015. <span>“Homogeneity
Pursuit.”</span> <em>Journal of the American Statistical
Association</em> 110 (509): 175–94.
</div>
<div id="ref-lin2017ordered" class="csl-entry">
Lin, You-Wu, Nan Xiao, Li-Li Wang, Chuan-Quan Li, and Qing-Song Xu.
2017. <span>“Ordered Homogeneity Pursuit Lasso for Group Variable
Selection with Applications to Spectroscopic Data.”</span>
<em>Chemometrics and Intelligent Laboratory Systems</em> 168: 62–71.
</div>
<div id="ref-tibshirani2011solution" class="csl-entry">
Tibshirani, Ryan J, Jonathan Taylor, et al. 2011. <span>“The Solution
Path of the Generalized Lasso.”</span> <em>The Annals of Statistics</em>
39 (3): 1335–71.
</div>
<div id="ref-zumel2016vtreat" class="csl-entry">
Zumel, Nina, and John Mount. 2016. <span>“<span class="nocase">vtreat</span>: A <span class="nocase">data.frame</span>
Processor for Predictive Modeling.”</span> <em>arXiv Preprint
arXiv:1611.09477</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nan Xiao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
